<!DOCTYPE html>
<html>
  <head>
        <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
  </head>
  <body>
    <div id= 'heatmap'></div>

        <script>
            var heatmap = {
                "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                "data": {"url": "https://raw.githubusercontent.com/AugustCzy/152_final_mc1/main/MC1/data/data.csv"},
                "title": "Count of visit by hours",
                // "transform": [{
                //     "filter": {"and": [
                //     {"field": "IMDB Rating", "valid": true},
                //     {"field": "Rotten Tomatoes Rating", "valid": true}
                //     ]}
                // }],
                'vconcat': [{
                            "mark": {"type": "line"},
                            "width": 800,
                            "height": 100,
                            "encoding": {
                                  "x": {
                                      "timeUnit": "utcyearmonthdate",
                                      "field": "Timestamp", 
                                      //"type": "ordinal",
                                  },
                                  "y": {
                                      "aggregate": "count",
                                      "field": "car-id", 
                                  },
                                  "color": {"field": "car-type"},
                                  "opacity": {
                                          "condition": {"param": "car-type", "value": 1},
                                          "value": 0.1
                                              },
                                  // "opacity": {
                                  //     "condition": {"param": "car-type", "value": 1},
                                  //     "value": 0.2
                                  // },
                              },

                              "params": [{
                                  "name": "brush",
                                  "select": {"type": "interval", "encodings": ["x"]}
                                },
                                {
                                    "name": "car-type",
                                    "select": {"type": "point", "fields": ["car-type"]},
                                    "bind": "legend"
                              }],

                          },
                        {
                          "transform": [{
                                  "filter": {"param": "car-type"}
                                }],
                          "mark": "rect",
                          "width": 800,
                          "height": 400,
                          "encoding": {
                              "x": {
                                  // "bin": {"maxbins":60},
                                  "timeUnit": "utcyearmonthdate",
                                  "field": "Timestamp", 
                                  //"type": "ordinal",
                                  "bin": {"extent": {"param": "brush"}}
                              },
                              "y": {
                                  // "bin": {"maxbins": 40},
                                  "field": "gate-name", 
                              },
                              "color": {
                                  "aggregate": "count",
                                  "type": "car-id"
                                  },
                          
                          "config": {
                                  "view": {
                                  "stroke": "transparent"
                                  }
                              },

                          }
                        }],
                
              }



            var heat_line = {

              "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
              "title": "Count of visit by hours",
              "width": 800,
              "height": 100,
              "data": {"url": "https://raw.githubusercontent.com/AugustCzy/152_final_mc1/main/MC1/data/data.csv"},
              "mark": {"type": "line"},
              "encoding": {
                    "x": {
                        "timeUnit": "utcyearmonthdate",
                        "field": "Timestamp", 
                        "type": "ordinal",
                    },
                    "y": {
                        "aggregate": "count",
                        "field": "car-id", 
                    },
                    "color": {"field": "car-type"},
                    // "opacity": {
                    //     "condition": {"param": "car-type", "value": 1},
                    //     "value": 0.2
                    // },
                },

                "params": [{
                    "name": "brush",
                    "select": {"type": "interval", "encodings": ["x"]}
                  }],

            }

            var heat = {'vconcat': [heat_line, heatmap]}
            vegaEmbed('#heatmap', heatmap)

        </script>
  </body>
</html>